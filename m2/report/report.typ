#import "@preview/basic-report:0.3.1": *
#import "@preview/physica:0.9.5": *

#show: it => basic-report(
  doc-category: "Отчет о лабораторной работе",
  doc-title: "М2. Бильярд",
  author: "Бабаков Илья Б13-404",
  affiliation: "мипт хссе",
  // logo: image("assets/logo.pdf", width: 2cm),
  language: "ru",
  compact-mode: false,
  it,
)

= Постановка задачи

== Задание

Смоделируйте столкновение идеально гладкого бильярдного
шара с бесконечно тяжёлой стенкой и с другим шаром. Расчёт реализуйте
двумя способами: 1) рассчитайте результат абсолютно упругого удара, в
явном виде применив законы сохранения; 2) детально смоделируйте упругое
столкновение, решая дифференциальное уравнение на основе 2-го закона
Ньютона, если шар считать деформируемым согласно закону Гука $F ~ Delta x$. Проверьте выполнение законов сохранения
по результатам такого расчёта.

= Теоретическая основа

Рассматриваются два шара радиуса $r$ и масс $m_1, m_2$, движущиеся в прямоугольной области
$[x_1, x_2] times [y_1, y_2]$ без трения.

Пусть центры шаров находятся в точках:
$
  va(r_1) = vecrow(x_1, y_1), quad
  va(r_2) = vecrow(x_2, y_2)
$

Скорости шаров:
$
  va(v_1) = (v_"1x", v_"1y"), quad
  va(v_2) = (v_"2x", v_"2y")
$

Между столкновениями движение равномерное прямолинейное (отсутствует трение):
$
  dv(va(r_i), t) = va(v_i), quad
  dv(va(v_i), t) = 0
$

Столкновения со стенками считаются абсолютно упругими.
При ударе о вертикальную стенку:
$
  v_"ix" ' = -v_"ix", quad
  v_"iy" ' = v_"iy"
$

При ударе о горизонтальную стенку:
$
  v_"iy" ' = -v_"iy", quad
  v_"ix" ' = v_"ix"
$

Модуль скорости сохраняется, а энергия системы остаётся неизменной.

=== Разложение скоростей

В момент столкновения определим вектор между центрами:
$
  va(d) = va(r)_2 - va(r)_1, quad d = |va(d)|, quad
  va(n) = va(d) / |va(d)|
$

Вектор $va(n)$ — нормаль линии центров.
Выберем также касательную $va(t)$, перпендикулярную нормали.
Разложим скорости на компоненты:
$
  v_"1n" = va(v)_1 dot va(n), quad
  v_"1t" = va(v)_1 dot va(t)
$
$
  v_"2n" = va(v)_2 dot va(n), quad
  v_"2t" = va(v)_2 dot va(t)
$

=== Решение для нормальных компонент

Силы действуют вдоль нормали, поэтому касательные компоненты сохраняются:
$
  v_"1t"' = v_"1t", quad v_"2t"' = v_"2t"
$

Для нормальных компонент решается система (импульс + энергия).
Получаем:
$
  v_"1n"' = v_"1n"(m_1 - m_2) + 2 m_2 v_"2n" / m_1 + m_2
$
$
  v_"2n"' = v_"2n"(m_2 - m_1) + 2 m_1 v_"1n" / m_1 + m_2
$

=== Сборка скоростей

После вычисления $v_"1n"', v_"2n"'$ возвращаемся в исходные координаты:
$
  va(v)_1' = v_"1n"' va(n) + v_"1t" va(t)
$
$
  va(v)_2' = v_"2n"' va(n) + v_"2t" va(t)
$

== Энергия системы

Кинетическая энергия:
$
  E_"kin" = 1 / 2 m_1 |va(v)_1|^2 + 1 / 2 m_2 |va(v)_2|^2
$

Потенциальная энергия (если используется модель упругих стенок):
$
  E_"pot" = 1 / 2 k Delta x^2
$
где $Delta x$ — глубина проникновения центра шара за стенку, $k$ — жёсткость.

Полная энергия:
$
  E_"total" = E_"kin" + E_"pot"
$

$E_"total"$ остаётся постоянной, что используется для проверки точности численного метода, однако ввиду неточности численных вычислений возможны небольшие перепады в момент удара.

== Численный метод

В программе применяется пошаговая интеграция по времени:
- обновление координат: $va(r)_i arrow.l va(r)_i + va(v)_i Delta t$
- проверка отражений от стен
- проверка столкновений шаров и обновление скоростей по формулам выше
- запись энергии $E_"total"$

=== Система уравнений в явном виде
Обозначим состояние как вектор
$ bold(s) = (x_1, y_1, v_1_x, v_1_y, x_2, y_2, v_2_x, v_2_y)^T $

Правая часть системы задается явно:
$ dot(x_i) = v_i_x $
$ dot(y_i) = v_i_y $
$ dot(v_i_x) = 1 / m F_i_x (r_1, r_2, v_1, v_2) $
$ dot(v_i_y) = 1 / m F_i_y (r_1, r_2, v_1, v_2) $
из З.С.И.
Суммарная сила $F_sum$ будет складываться из суммы силы соударения со стеной и силы давления шара (вычисляемой по закону Гука).